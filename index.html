<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Varanasi 2026: A Spiritual Journey</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,600;0,900;1,600&family=Inter:wght@300;400;500;700&display=swap');
        
        body { font-family: 'Inter', sans-serif; background-color: #0c0a09; color: #fdfaf6; overflow-x: hidden; }
        h1, h2, h3, .serif { font-family: 'Playfair Display', serif; }
        
        .text-gradient {
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-image: linear-gradient(to right, #ea580c, #fbbf24);
        }
        
        .glass-panel {
            background: rgba(28, 25, 23, 0.6);
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            border: 1px solid rgba(255, 255, 255, 0.05);
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
        }

        .nav-blur { 
            background: rgba(12, 10, 9, 0.8); 
            backdrop-filter: blur(20px); 
            -webkit-backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(255,255,255,0.05);
        }

        .reveal { opacity: 0; transform: translateY(40px); transition: all 0.8s cubic-bezier(0.16, 1, 0.3, 1); }
        .reveal.active { opacity: 1; transform: translateY(0); }
        .reveal-delay-1 { transition-delay: 0.1s; }
        .reveal-delay-2 { transition-delay: 0.2s; }
        .reveal-delay-3 { transition-delay: 0.3s; }

        .chart-container { position: relative; width: 100%; max-width: 700px; margin: 0 auto; height: 350px; }
        
        .image-card-overlay { background: linear-gradient(0deg, #0c0a09 0%, rgba(12,10,9,0.4) 50%, transparent 100%); }

        .itinerary-line {
            position: absolute; left: -13px; top: 20px; bottom: -20px; width: 2px;
            background: linear-gradient(to bottom, #ea580c, rgba(234,88,12,0.1));
        }
        .itinerary-node::before {
            content: ''; position: absolute; left: -17px; top: 10px; width: 10px; height: 10px;
            border-radius: 50%; background: #fbbf24; box-shadow: 0 0 10px #ea580c; z-index: 10;
        }

        .tab-active { color: #fbbf24; border-bottom: 2px solid #ea580c; font-weight: 700; }
        .tab-inactive { color: #78716c; border-bottom: 2px solid transparent; transition: color 0.3s; }
        .tab-inactive:hover { color: #d6d3d1; }
        
        .surprise-overlay { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.9); z-index: 1000; align-items: center; justify-content: center; padding: 20px; backdrop-filter: blur(10px); }
        .surprise-overlay.active { display: flex; animation: fadeIn 0.4s ease; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        .loader {
            border: 3px solid rgba(255,255,255,0.1); border-top: 3px solid #ea580c;
            border-radius: 50%; width: 20px; height: 20px; animation: spin 1s linear infinite; display: inline-block;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        #embersCanvas { position: absolute; inset: 0; width: 100%; height: 100%; pointer-events: none; z-index: 2; }
        #parallax-bg { will-change: transform; }

        /* Custom Trishul Cursor */
        @media (pointer: fine) {
            body, a, button, input, .cursor-pointer, [onclick] { cursor: none !important; }
        }
        @media (pointer: coarse) {
            .custom-cursor { display: none !important; }
        }
        .custom-cursor {
            position: fixed; top: 0; left: 0; width: 30px; height: 30px; pointer-events: none; z-index: 10000;
            transform: translate(-50%, -15px); font-size: 28px; line-height: 1; text-align: center;
            text-shadow: 0 0 15px #ea580c, 0 0 30px #fbbf24;
            transition: transform 0.15s ease-out, text-shadow 0.15s ease-out;
            will-change: transform, left, top;
        }
        .custom-cursor.clicking { transform: translate(-50%, -15px) scale(0.8); }
        .custom-cursor.hovering {
            transform: translate(-50%, -15px) scale(1.4);
            text-shadow: 0 0 25px #fbbf24, 0 0 50px #ea580c;
        }
    </style>
</head>
<body class="selection:bg-orange-500 selection:text-white">

    <!-- Custom Trishul Cursor -->
    <div id="custom-cursor" class="custom-cursor">üî±</div>

    <!-- Navigation -->
    <nav class="fixed top-0 w-full z-50 nav-blur transition-all duration-300" id="navbar">
        <div class="max-w-7xl mx-auto px-6 h-20 flex items-center justify-between">
            <div class="text-3xl font-black tracking-tighter text-white">
                KASHI<span class="text-orange-600">.</span><span class="text-stone-500 font-light text-xl">2026</span>
            </div>
            <div class="hidden md:flex items-center space-x-8 text-xs font-bold uppercase tracking-widest text-stone-400">
                <a href="#hero" class="hover:text-white transition-colors">Vision</a>
                <a href="#journey" class="hover:text-white transition-colors">Journey</a>
                <a href="#itinerary" class="hover:text-white transition-colors">Master Plan</a>
                <a href="#budget" class="hover:text-white transition-colors">Economics</a>
                <button onclick="vibeCheck()" class="bg-gradient-to-r from-orange-600 to-orange-500 text-white px-6 py-2 rounded-full hover:shadow-[0_0_20px_rgba(234,88,12,0.4)] transition-all">
                    Initiate
                </button>
            </div>
        </div>
    </nav>

    <!-- Immersive Hero Section -->
    <section id="hero" class="relative h-screen flex items-center justify-center overflow-hidden bg-black">
        <img id="parallax-bg" src="https://images.unsplash.com/photo-1561359313-0639aad49ca6?auto=format&fit=crop&q=80&w=2000" alt="Varanasi Riverfront" class="absolute inset-0 w-full h-[120%] object-cover opacity-60">
        <canvas id="embersCanvas"></canvas>
        <div class="absolute inset-0 bg-gradient-to-b from-transparent via-black/40 to-[#0c0a09] z-10"></div>
        
        <div class="relative z-20 text-center px-4 w-full max-w-5xl mx-auto mt-20">
            <h1 class="text-7xl md:text-9xl font-black text-white mb-6 drop-shadow-2xl tracking-tight reveal">
                VARANASI
            </h1>
            <p class="text-2xl md:text-3xl text-stone-300 font-light max-w-2xl mx-auto mb-12 drop-shadow serif reveal reveal-delay-1">
                The city older than history itself.
            </p>
            
            <button id="tts-btn" onclick="speakIntro()" class="reveal reveal-delay-2 group relative overflow-hidden glass-panel text-white px-8 py-4 rounded-full transition-all hover:bg-white/10 hover:border-orange-500/50 mb-16 inline-flex items-center gap-3">
                <div class="absolute inset-0 w-full h-full bg-gradient-to-r from-orange-600/20 to-amber-500/20 opacity-0 group-hover:opacity-100 transition-opacity"></div>
                <span id="tts-icon" class="text-orange-500 text-xl">üîä</span> 
                <span id="tts-text" class="font-bold tracking-widest uppercase text-sm">Listen to the Oracle</span>
            </button>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 reveal reveal-delay-3">
                <div class="glass-panel p-6 rounded-2xl border-t border-orange-500/30">
                    <div class="text-4xl font-black text-white mb-1">‚Çπ14.3k</div>
                    <div class="text-xs uppercase tracking-widest text-stone-400">Estimated Core Budget</div>
                </div>
                <div class="glass-panel p-6 rounded-2xl border-t border-orange-500/30">
                    <div class="text-4xl font-black text-white mb-1">4 Days</div>
                    <div class="text-xs uppercase tracking-widest text-stone-400">Duration (April '26)</div>
                </div>
                <div class="glass-panel p-6 rounded-2xl border-t border-orange-500/30">
                    <div class="text-4xl font-black text-white mb-1">Split</div>
                    <div class="text-xs uppercase tracking-widest text-stone-400">Heat Management Strategy</div>
                </div>
            </div>
        </div>
    </section>

    <!-- Visual Journey Selection -->
    <section id="journey" class="py-32 px-6 max-w-7xl mx-auto relative z-20 bg-[#0c0a09]">
        <div class="mb-20 text-center reveal">
            <h2 class="text-5xl md:text-6xl font-black mb-6">Choose Your <span class="text-gradient">Path</span></h2>
            <p class="text-stone-400 text-xl font-light">Departing Nagpur. Align your journey with your shift.</p>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-10">
            <!-- Train 1 -->
            <div class="reveal group relative h-[500px] rounded-[2.5rem] overflow-hidden cursor-pointer" onclick="selectTrain(1)" id="t1">
                <img src="https://images.unsplash.com/photo-1506461883276-594a12b11cf3?auto=format&fit=crop&q=80&w=1000" alt="Indian Railway Journey" class="absolute inset-0 w-full h-full object-cover transition-transform duration-1000 group-hover:scale-110">
                <div class="absolute inset-0 image-card-overlay transition-opacity duration-500"></div>
                <div class="absolute inset-0 border-4 border-orange-500 rounded-[2.5rem] opacity-100 transition-opacity" id="t1-ring"></div>

                <div class="absolute inset-0 p-10 flex flex-col justify-end text-white z-10">
                    <div class="bg-orange-600/90 backdrop-blur text-[10px] font-black px-3 py-1.5 rounded-full mb-4 inline-block w-fit tracking-widest">PRIME CHOICE</div>
                    <h3 class="text-4xl font-black mb-2">12791 Express</h3>
                    <p class="text-stone-300 font-light mb-6">Daily Departure ‚Ä¢ Perfect for Support Shifts</p>
                    
                    <div class="flex items-center justify-between border-t border-white/20 pt-6">
                        <div>
                            <div class="text-sm text-stone-400 mb-1">Departs NGP</div>
                            <div class="text-3xl font-bold">18:25</div>
                        </div>
                        <div class="h-px bg-white/20 flex-grow mx-6 relative">
                            <div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 text-xs bg-[#0c0a09] px-2 rounded-full text-stone-400">19h</div>
                        </div>
                        <div class="text-right">
                            <div class="text-sm text-stone-400 mb-1">Arrives Kashi</div>
                            <div class="text-3xl font-bold">13:25</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Train 2 -->
            <div class="reveal reveal-delay-1 group relative h-[500px] rounded-[2.5rem] overflow-hidden cursor-pointer grayscale opacity-60 hover:grayscale-0 hover:opacity-100 transition-all duration-700" onclick="selectTrain(2)" id="t2">
                <img src="https://images.unsplash.com/photo-1474487548417-781cb71495f3?auto=format&fit=crop&q=80&w=1000" alt="Morning Station" class="absolute inset-0 w-full h-full object-cover transition-transform duration-1000 group-hover:scale-110">
                <div class="absolute inset-0 image-card-overlay"></div>
                <div class="absolute inset-0 border-4 border-transparent rounded-[2.5rem] transition-colors" id="t2-ring"></div>

                <div class="absolute inset-0 p-10 flex flex-col justify-end text-white z-10">
                    <h3 class="text-4xl font-black mb-2">12669 Kaveri</h3>
                    <p class="text-stone-300 font-light mb-6">Mon, Sat ‚Ä¢ Early Morning Run</p>
                    
                    <div class="flex items-center justify-between border-t border-white/20 pt-6">
                        <div>
                            <div class="text-sm text-stone-400 mb-1">Departs NGP</div>
                            <div class="text-3xl font-bold">10:30</div>
                        </div>
                        <div class="h-px bg-white/20 flex-grow mx-6 relative">
                            <div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 text-xs bg-[#0c0a09] px-2 rounded-full text-stone-400">18h</div>
                        </div>
                        <div class="text-right">
                            <div class="text-sm text-stone-400 mb-1">Arrives Kashi</div>
                            <div class="text-3xl font-bold">05:10</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Heat Strategy Section -->
    <section class="py-32 px-6 bg-[#0c0a09] relative">
        <div class="max-w-7xl mx-auto flex flex-col lg:flex-row items-center gap-16">
            <div class="lg:w-1/2 reveal">
                <h2 class="text-5xl md:text-7xl font-black mb-8 leading-tight">Mastering the <br><span class="text-gradient">April Fire</span></h2>
                <p class="text-stone-400 text-xl font-light mb-10 leading-relaxed">
                    Varanasi hits 40¬∞C in April. Our scientifically balanced "Split Schedule" ensures you experience the golden hours at the ghats and take sanctuary during the midday inferno.
                </p>
                <div class="flex flex-col sm:flex-row gap-6">
                    <div class="glass-panel p-6 rounded-2xl border-l-4 border-blue-500 flex-1">
                        <div class="text-blue-400 font-bold tracking-widest text-xs uppercase mb-2">Sanctuary Mode</div>
                        <div class="text-white font-black text-2xl">11:30 - 16:30</div>
                        <div class="text-stone-500 text-sm mt-1">Strict indoor rest</div>
                    </div>
                    <div class="glass-panel p-6 rounded-2xl border-l-4 border-orange-500 flex-1">
                        <div class="text-orange-400 font-bold tracking-widest text-xs uppercase mb-2">Exploration Mode</div>
                        <div class="text-white font-black text-2xl">05:00 - 10:30</div>
                        <div class="text-stone-500 text-sm mt-1">Ghats & Temples</div>
                    </div>
                </div>
            </div>
            <div class="lg:w-1/2 w-full reveal reveal-delay-2">
                <div class="glass-panel p-6 rounded-[2rem] w-full">
                    <div class="chart-container w-full">
                        <canvas id="heatStrategyChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Master Plan Itinerary -->
    <section id="itinerary" class="py-32 px-6 max-w-7xl mx-auto">
        <div class="text-center mb-20 reveal">
            <h2 class="text-5xl md:text-6xl font-black mb-6">The Master <span class="text-gradient">Plan</span></h2>
            <p class="text-stone-400 text-xl font-light">A curated rhythm of spirituality and survival.</p>
        </div>
        
        <div class="reveal flex space-x-8 mb-16 border-b border-stone-800 overflow-x-auto justify-center">
            <button onclick="switchDay(1)" id="tab1" class="tab-active pb-6 px-4 whitespace-nowrap tracking-widest uppercase text-sm">Day 01: Arrival</button>
            <button onclick="switchDay(2)" id="tab2" class="tab-inactive pb-6 px-4 whitespace-nowrap tracking-widest uppercase text-sm">Day 02: The Soul</button>
            <button onclick="switchDay(3)" id="tab3" class="tab-inactive pb-6 px-4 whitespace-nowrap tracking-widest uppercase text-sm">Day 03: Sarnath</button>
            <button onclick="switchDay(4)" id="tab4" class="tab-inactive pb-6 px-4 whitespace-nowrap tracking-widest uppercase text-sm">Day 04: Farewell</button>
        </div>

        <div id="itinerary-content" class="grid grid-cols-1 lg:grid-cols-12 gap-16 items-start">
            <!-- Timeline injected via JS -->
        </div>
    </section>

    <!-- Budget Dashboard -->
    <section id="budget" class="py-32 px-6 relative border-t border-stone-800">
        <div class="absolute inset-0 bg-stone-900/20"></div>
        <div class="max-w-7xl mx-auto relative z-10">
            <div class="text-center mb-20 reveal">
                <h2 class="text-5xl md:text-6xl font-black mb-6">Economic <span class="text-gradient">Analysis</span></h2>
            </div>
            
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-20 items-center">
                <div class="reveal relative h-[400px] w-full flex items-center justify-center glass-panel rounded-[3rem] p-8">
                    <canvas id="budgetChart" class="relative z-10"></canvas>
                    <div class="absolute flex flex-col items-center justify-center pointer-events-none z-0">
                        <span class="text-stone-500 text-xs uppercase tracking-widest font-bold mb-1">Total Impact</span>
                        <span class="text-5xl font-black text-white">‚Çπ14.3k</span>
                    </div>
                </div>
                
                <div class="space-y-6">
                    <div class="reveal reveal-delay-1 glass-panel p-8 rounded-3xl flex items-center group hover:border-orange-500/50 transition-colors">
                        <div class="w-16 h-16 bg-stone-800 rounded-2xl flex items-center justify-center text-3xl mr-6 group-hover:scale-110 transition-transform shadow-inner">üöÑ</div>
                        <div class="flex-grow">
                            <div class="text-stone-400 uppercase tracking-widest text-xs font-bold mb-1">Transport</div>
                            <div class="text-white text-2xl font-black">‚Çπ3,500</div>
                        </div>
                    </div>
                    <div class="reveal reveal-delay-2 glass-panel p-8 rounded-3xl flex items-center group hover:border-orange-500/50 transition-colors">
                        <div class="w-16 h-16 bg-stone-800 rounded-2xl flex items-center justify-center text-3xl mr-6 group-hover:scale-110 transition-transform shadow-inner">üè®</div>
                        <div class="flex-grow">
                            <div class="text-stone-400 uppercase tracking-widest text-xs font-bold mb-1">AC Sanctuary (3 Nights)</div>
                            <div class="text-white text-2xl font-black">‚Çπ4,500</div>
                        </div>
                    </div>
                    <div class="reveal reveal-delay-3 glass-panel p-8 rounded-3xl flex items-center group hover:border-orange-500/50 transition-colors">
                        <div class="w-16 h-16 bg-stone-800 rounded-2xl flex items-center justify-center text-3xl mr-6 group-hover:scale-110 transition-transform shadow-inner">üç≤</div>
                        <div class="flex-grow">
                            <div class="text-stone-400 uppercase tracking-widest text-xs font-bold mb-1">Sustenance & Hydration</div>
                            <div class="text-white text-2xl font-black">‚Çπ2,800</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Commitment Section -->
    <section class="py-40 px-6 text-center relative overflow-hidden bg-black border-t border-stone-800">
        <div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[800px] h-[800px] bg-orange-600/20 rounded-full blur-[120px] pointer-events-none"></div>
        
        <div class="max-w-4xl mx-auto relative z-10 reveal">
            <div class="text-orange-500 font-black text-6xl mb-8 opacity-80">üïâÔ∏è</div>
            <h2 class="text-7xl md:text-8xl font-black mb-8 text-white tracking-tighter">ARE YOU IN?</h2>
            <p class="text-stone-400 text-2xl mb-16 font-light max-w-2xl mx-auto">The team is vibing. Kashi is calling. Let's make this leave count.</p>
            
            <button onclick="vibeCheck()" class="group relative inline-flex items-center justify-center px-16 py-8 font-black text-white text-3xl transition-all duration-300 bg-transparent rounded-full overflow-hidden hover:scale-105">
                <div class="absolute inset-0 w-full h-full bg-gradient-to-r from-orange-600 via-amber-500 to-orange-600 bg-[length:200%_auto] animate-[gradient_2s_linear_infinite]"></div>
                <div class="absolute inset-1 bg-black/40 rounded-full backdrop-blur-sm group-hover:bg-transparent transition-colors duration-300"></div>
                <span class="relative z-10 tracking-widest">INITIATE BOOKING üöÑ</span>
            </button>
        </div>
    </section>

    <!-- Surprise Overlay -->
    <div id="surprise-overlay" class="surprise-overlay" onclick="closeSurprise()">
        <div class="glass-panel p-16 rounded-[3rem] max-w-2xl w-full text-center relative overflow-hidden border border-orange-500/50 shadow-[0_0_100px_rgba(234,88,12,0.3)]" onclick="event.stopPropagation()">
            <div class="text-7xl mb-8">üôå</div>
            <h2 class="text-5xl font-black text-white mb-6 tracking-tighter">HAR HAR MAHADEV!</h2>
            <p class="text-stone-300 text-xl mb-10 font-light leading-relaxed">
                Varanasi is the City of Light. Even the sun bows down here! You've just committed to a journey that changes lives.
            </p>
            <div class="text-2xl font-black text-orange-500 mb-12 uppercase tracking-widest">The entire team is vibing!</div>
            
            <button onclick="shareToWhatsApp()" class="w-full py-6 bg-white text-black font-black rounded-full hover:bg-stone-200 transition text-xl tracking-widest uppercase flex items-center justify-center gap-3">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 16 16"><path d="M13.601 2.326A7.854 7.854 0 0 0 7.994 0C3.627 0 .068 3.558.064 7.926c0 1.399.366 2.76 1.057 3.965L0 16l4.204-1.102a7.933 7.933 0 0 0 3.79.965h.004c4.368 0 7.926-3.558 7.93-7.93A7.898 7.898 0 0 0 13.6 2.326zM7.994 14.521a6.573 6.573 0 0 1-3.356-.92l-.24-.144-2.494.654.666-2.433-.156-.251a6.56 6.56 0 0 1-1.007-3.505c0-3.626 2.957-6.584 6.591-6.584a6.56 6.56 0 0 1 4.66 1.931 6.557 6.557 0 0 1 1.928 4.66c-.004 3.639-2.961 6.592-6.592 6.592zm3.615-4.934c-.197-.099-1.17-.578-1.353-.646-.182-.065-.315-.099-.445.099-.133.197-.513.646-.627.775-.114.133-.232.148-.43.05-.197-.1-.836-.308-1.592-.985-.59-.525-.985-1.175-1.103-1.372-.114-.198-.011-.304.088-.403.087-.088.197-.232.296-.346.1-.114.133-.198.198-.33.065-.134.034-.248-.015-.347-.05-.099-.445-1.076-.612-1.47-.16-.389-.323-.335-.445-.34-.114-.007-.247-.007-.38-.007a.729.729 0 0 0-.529.247c-.182.198-.691.677-.691 1.654 0 .977.71 1.916.81 2.049.098.133 1.394 2.132 3.383 2.992.47.205.84.326 1.129.418.475.152.904.129 1.246.08.38-.058 1.171-.48 1.338-.943.164-.464.164-.86.114-.943-.049-.084-.182-.133-.38-.232z"/></svg>
                Tell The Team
            </button>
        </div>
    </div>

    <footer class="bg-black text-stone-600 py-16 text-center border-t border-stone-900">
        <div class="text-2xl font-black text-white mb-2 tracking-tighter">KASHI<span class="text-orange-600">.</span>2026</div>
        <p class="text-sm tracking-widest uppercase">Support Team Expedition ‚Ä¢ Designed for the Future</p>
    </footer>

    <script>
        const apiKey = ""; // API Key provided by environment

        // --------------------------------------------------------
        // 1. Scroll Reveals & Parallax
        // --------------------------------------------------------
        const observerOptions = { threshold: 0.1, rootMargin: "0px 0px -50px 0px" };
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => { if(entry.isIntersecting) entry.target.classList.add('active'); });
        }, observerOptions);

        document.querySelectorAll('.reveal').forEach(el => observer.observe(el));

        const parallaxBg = document.getElementById('parallax-bg');
        const navbar = document.getElementById('navbar');
        window.addEventListener('scroll', () => {
            let scrollY = window.scrollY;
            if(parallaxBg) parallaxBg.style.transform = `translateY(${scrollY * 0.4}px)`;
            if(scrollY > 50) {
                navbar.classList.add('bg-black/80', 'backdrop-blur-xl');
                navbar.classList.remove('bg-transparent');
            } else {
                navbar.classList.remove('bg-black/80', 'backdrop-blur-xl');
                navbar.classList.add('bg-transparent');
            }
        });

        // --------------------------------------------------------
        // 2. Canvas Particle Engine (Aarti Embers)
        // --------------------------------------------------------
        const canvas = document.getElementById('embersCanvas');
        const ctx = canvas.getContext('2d');
        let particles = [];
        
        function resizeCanvas() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        }
        window.addEventListener('resize', resizeCanvas);
        resizeCanvas();

        class Particle {
            constructor() {
                this.x = Math.random() * canvas.width;
                this.y = canvas.height + Math.random() * 100;
                this.size = Math.random() * 3 + 1;
                this.speedY = Math.random() * -1 - 0.5;
                this.speedX = (Math.random() - 0.5) * 1;
                this.opacity = Math.random() * 0.8 + 0.2;
                this.color = `rgba(251, 146, 60, ${this.opacity})`;
            }
            update() {
                this.y += this.speedY;
                this.x += this.speedX;
                if(this.y < -10) { this.y = canvas.height + 10; this.x = Math.random() * canvas.width; }
            }
            draw() {
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                ctx.fillStyle = this.color;
                ctx.shadowBlur = 10;
                ctx.shadowColor = '#ea580c';
                ctx.fill();
            }
        }

        function initParticles() { for(let i=0; i<70; i++) particles.push(new Particle()); }
        function animateParticles() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            particles.forEach(p => { p.update(); p.draw(); });
            requestAnimationFrame(animateParticles);
        }
        initParticles(); animateParticles();

        // --------------------------------------------------------
        // 3. Gemini AI Features
        // --------------------------------------------------------
        async function speakIntro() {
            const btn = document.getElementById('tts-btn');
            const icon = document.getElementById('tts-icon');
            const btnText = document.getElementById('tts-text');
            btn.disabled = true;
            icon.innerHTML = '<span class="loader border-white border-t-orange-500"></span>';

            const text = "Say in a deep, majestic, and dramatic Indian baritone voice: Welcome traveler. Varanasi, the city as old as time itself, awaits you. In the rising sun of April, Kashi breathes light. We will explore the ancient ghats, witness the divine fire of the Aarti, and find peace. Are you ready for the journey of a lifetime?";
            
            const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-tts:generateContent?key=${apiKey}`;
            const payload = {
                contents: [{ parts: [{ text }] }],
                generationConfig: {
                    responseModalities: ["AUDIO"],
                    speechConfig: { voiceConfig: { prebuiltVoiceConfig: { voiceName: "Fenrir" } } }
                }
            };

            try {
                const response = await fetch(url, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(payload) });
                const data = await response.json();
                
                if (!data.candidates || !data.candidates[0] || !data.candidates[0].content || !data.candidates[0].content.parts || !data.candidates[0].content.parts[0].inlineData) {
                    throw new Error("Invalid response format from TTS API");
                }

                const pcmBase64 = data.candidates[0].content.parts[0].inlineData.data;
                const mimeType = data.candidates[0].content.parts[0].inlineData.mimeType || 'audio/L16;rate=24000';
                const sampleRateMatch = mimeType.match(/rate=(\d+)/);
                const sampleRate = sampleRateMatch ? parseInt(sampleRateMatch[1]) : 24000;
                
                const audioBuffer = base64ToUint8Array(pcmBase64);
                const wavBlob = pcmToWav(audioBuffer, sampleRate);
                const audioUrl = URL.createObjectURL(wavBlob);
                const audio = new Audio(audioUrl);
                audio.play();
                audio.onended = () => { btn.disabled = false; icon.innerHTML = 'üîä'; };
            } catch (e) {
                btn.disabled = false; icon.innerHTML = '‚ö†Ô∏è'; btnText.innerText = 'Voice Unavailable';
                setTimeout(() => { icon.innerHTML = 'üîä'; btnText.innerText = 'Listen to the Oracle'; }, 3000);
            }
        }

        function base64ToUint8Array(base64) {
            const binaryString = atob(base64);
            const bytes = new Uint8Array(binaryString.length);
            for (let i = 0; i < binaryString.length; i++) bytes[i] = binaryString.charCodeAt(i);
            return bytes;
        }

        function pcmToWav(pcmData, sampleRate) {
            const buffer = new ArrayBuffer(44 + pcmData.length);
            const view = new DataView(buffer);
            const writeString = (offset, string) => { for (let i = 0; i < string.length; i++) view.setUint8(offset + i, string.charCodeAt(i)); };
            writeString(0, 'RIFF'); view.setUint32(4, 36 + pcmData.length, true); writeString(8, 'WAVE'); writeString(12, 'fmt ');
            view.setUint32(16, 16, true); view.setUint16(20, 1, true); view.setUint16(22, 1, true); view.setUint32(24, sampleRate, true);
            view.setUint32(28, sampleRate * 2, true); view.setUint16(32, 2, true); view.setUint16(34, 16, true); writeString(36, 'data');
            view.setUint32(40, pcmData.length, true);
            const pcmView = new Uint8Array(buffer, 44); pcmView.set(pcmData);
            return new Blob([buffer], { type: 'audio/wav' });
        }

        // --------------------------------------------------------
        // 4. Content Logic (Custom Local Images)
        // --------------------------------------------------------
        // IMPORTANT: Ensure your images are saved in the EXACT same folder as this HTML file!
        const appData = {
            day1: [
                { time: '13:30', title: 'Arrival', desc: 'Transfer to Sanctuary. Welcome to the City of Light.', localImg: 'arrival.jpg', webImg: 'https://images.unsplash.com/photo-1587474260584-136574528ed5?auto=format&fit=crop&q=80&w=600' },
                { time: '18:30', title: 'Evening Aarti', desc: 'Witness the divine offering at Dashashwamedh Ghat.', localImg: 'aarti.jpg', webImg: 'https://images.unsplash.com/photo-1590050752117-23a9d7fc9153?auto=format&fit=crop&q=80&w=600' }
            ],
            day2: [
                { time: '05:00', title: 'Subah-e-Banaras', desc: 'Sunrise boat ride and music at Assi Ghat.', localImg: 'subah.jpg', webImg: 'https://images.unsplash.com/photo-1595232770857-f6d2346617ba?auto=format&fit=crop&q=80&w=600' },
                { time: '07:30', title: 'Temple Precincts', desc: 'Exploring the Kashi Vishwanath corridor.', localImg: 'temple.jpg', webImg: 'https://images.unsplash.com/photo-1544085311-11a028465b03?auto=format&fit=crop&q=80&w=600' },
                { time: '18:00', title: 'Old City Walks', desc: 'Exploring hidden alleys and silk weavers.', localImg: 'alleys.jpg', webImg: 'https://images.unsplash.com/photo-1518105611010-ca68ba012348?auto=format&fit=crop&q=80&w=600' }
            ],
            day3: [
                { time: '06:00', title: 'Sarnath Stupa', desc: 'Peaceful morning at the Buddhist ruins.', localImg: 'sarnath.jpg', webImg: 'https://images.unsplash.com/photo-1599661046289-e31897846e41?auto=format&fit=crop&q=80&w=600' },
                { time: '17:00', title: 'BHU & Birla Temple', desc: 'Sunset within the University grounds.', localImg: 'bhu.jpg', webImg: 'https://images.unsplash.com/photo-1566438480900-0609be27a4be?auto=format&fit=crop&q=80&w=600' }
            ],
            day4: [
                { time: '10:00', title: 'Final Markets', desc: 'Picking up Banarasi Silks and sweets.', localImg: 'markets.jpg', webImg: 'https://images.unsplash.com/photo-1610483178766-8092dcc6f34a?auto=format&fit=crop&q=80&w=600' },
                { time: '12:30', title: 'Varanasi Junction', desc: 'Heading back to Nagpur.', localImg: 'junction.jpg', webImg: 'https://images.unsplash.com/photo-1506461883276-594a12b11cf3?auto=format&fit=crop&q=80&w=600' }
            ]
        };

        function switchDay(day) {
            for(let i=1; i<=4; i++) {
                const tab = document.getElementById(`tab${i}`);
                if(tab) tab.className = (i === day) ? 'tab-active pb-6 px-4 whitespace-nowrap tracking-widest uppercase text-sm' : 'tab-inactive pb-6 px-4 whitespace-nowrap tracking-widest uppercase text-sm';
            }
            const container = document.getElementById('itinerary-content');
            const items = appData[`day${day}`];
            
            if (container) {
                container.style.opacity = '0';
                setTimeout(() => {
                    container.innerHTML = `
                        <div class="col-span-1 lg:col-span-5 space-y-16 pl-4 pt-4">
                            ${items.map((item, idx) => `
                                <div class="relative pl-12 itinerary-node reveal active" style="transition-delay: ${idx * 0.1}s">
                                    <div class="itinerary-line"></div>
                                    <div class="text-orange-500 font-bold tracking-widest text-sm mb-2 font-mono">${item.time}</div>
                                    <h4 class="text-3xl font-black text-white mb-3 tracking-tight">${item.title}</h4>
                                    <p class="text-stone-400 font-light text-lg">${item.desc}</p>
                                </div>
                            `).join('')}
                        </div>
                        <div class="col-span-1 lg:col-span-7 grid grid-cols-1 md:grid-cols-2 gap-6">
                            ${items.map((item, idx) => `
                                <div class="reveal active group overflow-hidden rounded-[2rem] h-64 shadow-2xl" style="transition-delay: ${idx * 0.15}s">
                                    <!-- Image Tag with Smart Fallback: Tries your specific local file first, falls back to web URL if missing -->
                                    <img src="${item.localImg}" onerror="this.onerror=null; this.src='${item.webImg}';" class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-700 filter brightness-75 group-hover:brightness-100" alt="${item.title}">
                                </div>
                            `).join('')}
                        </div>
                    `;
                    container.style.opacity = '1';
                }, 300);
            }
        }

        function selectTrain(id) {
            const t1 = document.getElementById('t1'); const t2 = document.getElementById('t2');
            const r1 = document.getElementById('t1-ring'); const r2 = document.getElementById('t2-ring');
            if(id === 1 && t1 && t2) { 
                t1.classList.remove('grayscale', 'opacity-60'); t2.classList.add('grayscale', 'opacity-60');
                r1.classList.remove('border-transparent'); r1.classList.add('border-orange-500');
                r2.classList.remove('border-orange-500'); r2.classList.add('border-transparent');
            } else if (t1 && t2) { 
                t2.classList.remove('grayscale', 'opacity-60'); t1.classList.add('grayscale', 'opacity-60');
                r2.classList.remove('border-transparent'); r2.classList.add('border-orange-500');
                r1.classList.remove('border-orange-500'); r1.classList.add('border-transparent');
            }
        }

        function vibeCheck() {
            confetti({ particleCount: 200, spread: 120, origin: { y: 0.6 }, colors: ['#ea580c', '#fbbf24', '#ffffff'], zIndex: 2000, gravity: 1.2 });
            const overlay = document.getElementById('surprise-overlay');
            if (overlay) setTimeout(() => overlay.classList.add('active'), 200);
        }

        function closeSurprise() {
            const overlay = document.getElementById('surprise-overlay');
            if (overlay) overlay.classList.remove('active');
        }

        function shareToWhatsApp() {
            const hiddenWhatsAppLink = "https://wa.link/mlbi2q";
            window.open(hiddenWhatsAppLink, '_blank');
            closeSurprise();
        }

        // --------------------------------------------------------
        // 5. Advanced Chart.js Setup
        // --------------------------------------------------------
        function initCharts() {
            Chart.defaults.color = '#a8a29e';
            Chart.defaults.font.family = 'Inter';

            const heatCanvas = document.getElementById('heatStrategyChart');
            if (heatCanvas) {
                new Chart(heatCanvas.getContext('2d'), {
                    type: 'line',
                    data: {
                        labels: ['5 AM', '8 AM', '11 AM', '2 PM', '5 PM', '8 PM'],
                        datasets: [
                            { label: 'Temp (¬∞C)', data: [24, 30, 39, 41, 35, 30], borderColor: '#ea580c', backgroundColor: 'rgba(234, 88, 12, 0.15)', fill: true, tension: 0.4, borderWidth: 3 },
                            { label: 'Exploration', data: [90, 85, 10, 5, 80, 70], borderColor: '#3b82f6', backgroundColor: 'rgba(59, 130, 246, 0.15)', fill: true, tension: 0.4, borderWidth: 3 }
                        ]
                    },
                    options: {
                        responsive: true, maintainAspectRatio: false,
                        plugins: { legend: { position: 'bottom' } },
                        scales: { y: { grid: { color: 'rgba(255,255,255,0.05)' } }, x: { grid: { display: false } } }
                    }
                });
            }

            const budgetCanvas = document.getElementById('budgetChart');
            if (budgetCanvas) {
                new Chart(budgetCanvas.getContext('2d'), {
                    type: 'doughnut',
                    data: {
                        labels: ['Stay', 'Food', 'Travel', 'Buffer'],
                        datasets: [{ data: [4500, 2800, 3500, 3500], backgroundColor: ['#ea580c', '#fbbf24', '#3b82f6', '#3f3f46'], borderWidth: 0, hoverOffset: 10 }]
                    },
                    options: {
                        responsive: true, maintainAspectRatio: false, cutout: '80%',
                        plugins: { legend: { display: false } },
                        animation: { animateScale: true, animateRotate: true }
                    }
                });
            }
        }

        // --------------------------------------------------------
        // 6. Custom Trishul Cursor Logic
        // --------------------------------------------------------
        function initCursor() {
            const cursor = document.getElementById('custom-cursor');
            if (window.matchMedia("(pointer: fine)").matches) {
                document.addEventListener('mousemove', (e) => {
                    cursor.style.left = e.clientX + 'px';
                    cursor.style.top = e.clientY + 'px';
                });
                
                document.addEventListener('mousedown', () => cursor.classList.add('clicking'));
                document.addEventListener('mouseup', () => cursor.classList.remove('clicking'));

                const addHoverEvents = () => {
                    const interactables = document.querySelectorAll('a, button, input, .cursor-pointer, [onclick]');
                    interactables.forEach(el => {
                        if(!el.dataset.cursorAttached) {
                            el.addEventListener('mouseenter', () => cursor.classList.add('hovering'));
                            el.addEventListener('mouseleave', () => cursor.classList.remove('hovering'));
                            el.dataset.cursorAttached = 'true';
                        }
                    });
                };
                
                addHoverEvents();
                setTimeout(addHoverEvents, 500);
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
            switchDay(1);
            initCharts();
            initCursor();
            setTimeout(() => window.dispatchEvent(new Event('scroll')), 100);
        });
    </script>
</body>
</html>
